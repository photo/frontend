(function(){function h(){this.returnValue=!1}function k(){this.cancelBubble=!0}var j=0,s=[],t={},r={},q={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},w=/[<>&\"\']/g,l=window.setTimeout,n={},o;(function(a){var a=a.split(/,/),b,f,c;for(b=0;b<a.length;b+=2){c=a[b+1].split(/ /);for(f=0;f<c.length;f++)r[c[f]]=a[b]}})("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/vnd.rn-realvideo,rv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");
var g={VERSION:"@@version@@",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:r,ua:function(){var a=navigator,b=a.userAgent,f=a.vendor,c,d;d=(c=/WebKit/.test(b))&&-1!==f.indexOf("Apple");f=window.opera&&window.opera.buildNumber;return{windows:-1!==navigator.platform.indexOf("Win"),
ie:!c&&!f&&/MSIE/gi.test(b)&&/Explorer/gi.test(a.appName),webkit:c,gecko:!c&&/Gecko/.test(b),safari:d,opera:!!f}}(),typeOf:function(a){return{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},extend:function(a){g.each(arguments,function(b,f){0<f&&g.each(b,function(b,d){a[d]=b})});return a},cleanName:function(a){var b,f;f=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,
"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(b=0;b<f.length;b+=2)a=a.replace(f[b],f[b+1]);a=a.replace(/\s+/g,"_");return a=a.replace(/[^a-z0-9_\-\.]+/gi,"")},addRuntime:function(a,b){b.name=a;s[a]=b;s.push(b);return b},guid:function(){var a=(new Date).getTime().toString(32),b;for(b=0;5>b;b++)a+=Math.floor(65535*Math.random()).toString(32);return(g.guidPrefix||"p")+a+(j++).toString(32)},buildUrl:function(a,b){var f="";g.each(b,function(a,b){f+=(f?"&":"")+encodeURIComponent(b)+
"="+encodeURIComponent(a)});f&&(a+=(0<a.indexOf("?")?"&":"?")+f);return a},each:function(a,b){var f,c;if(a)if(f=a.length,void 0===f)for(c in a){if(a.hasOwnProperty(c)&&!1===b(a[c],c))break}else for(c=0;c<f&&!(!1===b(a[c],c));c++);},formatSize:function(a){return void 0===a||/\D/.test(a)?g.translate("N/A"):1073741824<a?Math.round(a/1073741824,1)+" GB":1048576<a?Math.round(a/1048576,1)+" MB":1024<a?Math.round(a/1024,1)+" KB":a+" b"},getPos:function(a,b){function f(a){var e,b=0;e=0;a&&(e=a.getBoundingClientRect(),
a="CSS1Compat"===p.compatMode?p.documentElement:p.body,b=e.left+a.scrollLeft,e=e.top+a.scrollTop);return{x:b,y:e}}var c=0,d=0,e,p=document,b=b||p.body;if(a&&a.getBoundingClientRect&&0<navigator.userAgent.indexOf("MSIE")&&8!==p.documentMode)return c=f(a),d=f(b),{x:c.x-d.x,y:c.y-d.y};for(e=a;e&&e!=b&&e.nodeType;)c+=e.offsetLeft||0,d+=e.offsetTop||0,e=e.offsetParent;for(e=a.parentNode;e&&e!=b&&e.nodeType;)c-=e.scrollLeft||0,d-=e.scrollTop||0,e=e.parentNode;return{x:c,y:d}},getSize:function(a){return{w:a.offsetWidth||
a.clientWidth,h:a.offsetHeight||a.clientHeight}},parseSize:function(a){var b;"string"==typeof a&&(a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,"")),b=a[2],a=+a[1],"g"==b&&(a*=1073741824),"m"==b&&(a*=1048576),"k"==b&&(a*=1024));return a},xmlEncode:function(a){return a?(""+a).replace(w,function(a){return q[a]?"&"+q[a]+";":a}):a},toArray:function(a){var b,f=[];for(b=0;b<a.length;b++)f[b]=a[b];return f},inArray:function(a,b){if(b){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(b,
a);for(var f=0,c=b.length;f<c;f++)if(b[f]===a)return f}return-1},addI18n:function(a){return g.extend(t,a)},translate:function(a){return t[a]||a},isEmptyObj:function(a){if(void 0===a)return!0;for(var b in a)return!1;return!0},hasClass:function(a,b){return""==a.className?!1:RegExp("(^|\\s+)"+b+"(\\s+|$)").test(a.className)},addClass:function(a,b){g.hasClass(a,b)||(a.className=""==a.className?b:a.className.replace(/\s+$/,"")+" "+b)},removeClass:function(a,b){a.className=a.className.replace(RegExp("(^|\\s+)"+
b+"(\\s+|$)"),function(a,b,d){return" "===b&&" "===d?" ":""})},getStyle:function(a,b){if(a.currentStyle)return a.currentStyle[b];if(window.getComputedStyle)return window.getComputedStyle(a,null)[b]},addEvent:function(a,b,f,c){var d,b=b.toLowerCase();void 0===o&&(o="Plupload_"+g.guid());a.addEventListener?(d=f,a.addEventListener(b,d,!1)):a.attachEvent&&(d=function(){var a=window.event;a.target||(a.target=a.srcElement);a.preventDefault=h;a.stopPropagation=k;f(a)},a.attachEvent("on"+b,d));void 0===a[o]&&
(a[o]=g.guid());n.hasOwnProperty(a[o])||(n[a[o]]={});a=n[a[o]];a.hasOwnProperty(b)||(a[b]=[]);a[b].push({func:d,orig:f,key:c})},removeEvent:function(a,b,f){var c,d;"function"==typeof f?c=f:d=f;b=b.toLowerCase();if(a[o]&&n[a[o]]&&n[a[o]][b]){for(var f=n[a[o]][b],e=f.length-1;0<=e;e--)if(f[e].key===d||f[e].orig===c)if(a.detachEvent?a.detachEvent("on"+b,f[e].func):a.removeEventListener&&a.removeEventListener(b,f[e].func,!1),f[e].orig=null,f[e].func=null,f.splice(e,1),void 0!==c)break;f.length||delete n[a[o]][b];
if(g.isEmptyObj(n[a[o]])){delete n[a[o]];try{delete a[o]}catch(p){a[o]=void 0}}}},removeAllEvents:function(a,b){void 0!==a[o]&&a[o]&&g.each(n[a[o]],function(f,c){g.removeEvent(a,c,b)})}};g.Uploader=function(a){function b(){var a,b=0,d;if(this.state==g.STARTED){e=this.files;for(d=0;d<e.length;d++)!a&&e[d].status==g.QUEUED?(a=e[d],a.status=g.UPLOADING,this.trigger("BeforeUpload",a)&&this.trigger("UploadFile",a)):b++;b==e.length&&(this.stop(),this.trigger("UploadComplete",e))}}function f(){var a,b;d.reset();
for(a=0;a<e.length;a++)b=e[a],void 0!==b.size?(d.size+=b.size,d.loaded+=b.loaded):d.size=void 0,b.status==g.DONE?d.uploaded++:b.status==g.FAILED?d.failed++:d.queued++;void 0===d.size?d.percent=0<e.length?Math.ceil(100*(d.uploaded/e.length)):0:(d.bytesPerSec=Math.ceil(d.loaded/((+new Date-p||1)/1E3)),d.percent=0<d.size?Math.ceil(100*(d.loaded/d.size)):0)}var c={},d,e=[],p,u=!1;d=new g.QueueProgress;a=g.extend({chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",filters:[]},a);g.extend(this,
{state:g.STOPPED,runtime:"",features:{},files:e,settings:a,total:d,id:g.guid(),init:function(){function d(){var a=u[j++],b,e,c;if(a){b=a.getFeatures();if(e=m.settings.required_features){e=e.split(",");for(c=0;c<e.length;c++)if(!b[e[c]]){d();return}}a.init(m,function(e){e&&e.success?(m.features=b,m.runtime=a.name,m.trigger("Init",{runtime:a.name}),m.trigger("PostInit"),m.refresh()):d()})}else m.trigger("Error",{code:g.INIT_ERROR,message:g.translate("Init error.")})}var m=this,c,u,j=0,h;"function"==
typeof a.preinit?a.preinit(m):g.each(a.preinit,function(a,e){m.bind(e,a)});a.page_url=a.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/");/^(\w+:\/\/|\/)/.test(a.url)||(a.url=a.page_url+a.url);a.chunk_size=g.parseSize(a.chunk_size);a.max_file_size=g.parseSize(a.max_file_size);m.bind("FilesAdded",function(b,d){var c,p,f=0,v;if((c=a.filters)&&c.length)v=[],g.each(c,function(a){g.each(a.extensions.split(/,/),function(a){/^\s*\*\s*$/.test(a)?v.push("\\.*"):v.push("\\."+a.replace(RegExp("["+
"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),v=RegExp(v.join("|")+"$","i");for(c=0;c<d.length;c++)p=d[c],p.loaded=0,p.percent=0,p.status=g.QUEUED,v&&!v.test(p.name)?b.trigger("Error",{code:g.FILE_EXTENSION_ERROR,message:g.translate("File extension error."),file:p}):void 0!==p.size&&p.size>a.max_file_size?b.trigger("Error",{code:g.FILE_SIZE_ERROR,message:g.translate("File size error."),file:p}):(e.push(p),f++);if(f)l(function(){m.trigger("QueueChanged");m.refresh()},1);else return!1});
a.unique_names&&m.bind("UploadFile",function(a,e){var b=e.name.match(/\.([^.]+)$/),d="tmp";b&&(d=b[1]);e.target_name=e.id+"."+d});m.bind("UploadProgress",function(a,e){e.percent=0<e.size?Math.ceil(100*(e.loaded/e.size)):100;f()});m.bind("StateChanged",function(a){if(a.state==g.STARTED)p=+new Date;else if(a.state==g.STOPPED)for(c=a.files.length-1;0<=c;c--)a.files[c].status==g.UPLOADING&&(a.files[c].status=g.QUEUED,f())});m.bind("QueueChanged",f);m.bind("Error",function(a,e){e.file&&(e.file.status=
g.FAILED,f(),a.state==g.STARTED&&l(function(){b.call(m)},1))});m.bind("FileUploaded",function(a,e){e.status=g.DONE;e.loaded=e.size;a.trigger("UploadProgress",e);l(function(){b.call(m)},1)});if(a.runtimes){u=[];h=a.runtimes.split(/\s?,\s?/);for(c=0;c<h.length;c++)s[h[c]]&&u.push(s[h[c]])}else u=s;d();"function"==typeof a.init?a.init(m):g.each(a.init,function(a,e){m.bind(e,a)})},refresh:function(){this.trigger("Refresh")},start:function(){this.state!=g.STARTED&&(this.state=g.STARTED,this.trigger("StateChanged"),
b.call(this))},stop:function(){this.state!=g.STOPPED&&(this.state=g.STOPPED,this.trigger("CancelUpload"),this.trigger("StateChanged"))},disableBrowse:function(a){u=void 0!==a?a:!0;this.trigger("DisableBrowse",u)},getFile:function(a){var b;for(b=e.length-1;0<=b;b--)if(e[b].id===a)return e[b]},removeFile:function(a){var b;for(b=e.length-1;0<=b;b--)if(e[b].id===a.id)return this.splice(b,1)[0]},splice:function(a,b){var d;d=e.splice(void 0===a?0:a,void 0===b?e.length:b);this.trigger("FilesRemoved",d);
this.trigger("QueueChanged");return d},trigger:function(a){var e=c[a.toLowerCase()],b,d;if(e){d=Array.prototype.slice.call(arguments);d[0]=this;for(b=0;b<e.length;b++)if(!1===e[b].func.apply(e[b].scope,d))return!1}return!0},hasEventListener:function(a){return!!c[a.toLowerCase()]},bind:function(a,e,b){var d,a=a.toLowerCase();d=c[a]||[];d.push({func:e,scope:b||this});c[a]=d},unbind:function(a,e){var a=a.toLowerCase(),b=c[a],d;if(b){if(void 0!==e)for(d=b.length-1;0<=d;d--){if(b[d].func===e){b.splice(d,
1);break}}else b=[];b.length||delete c[a]}},unbindAll:function(){var a=this;g.each(c,function(b,e){a.unbind(e)})},destroy:function(){this.stop();this.trigger("Destroy");this.unbindAll()}})};g.File=function(a,b,f){this.id=a;this.name=b;this.size=f;this.status=this.percent=this.loaded=0};g.Runtime=function(){this.getFeatures=function(){};this.init=function(){}};g.QueueProgress=function(){var a=this;a.size=0;a.loaded=0;a.uploaded=0;a.failed=0;a.queued=0;a.percent=0;a.bytesPerSec=0;a.reset=function(){a.size=
a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0}};g.runtimes={};window.plupload=g})();
(function(h,k,j,s){function t(a,b){var f;if("FileReader"in h)f=new FileReader,f.readAsDataURL(a),f.onload=function(){b(f.result)};else return b(a.getAsDataURL())}function r(a,b){var f;if("FileReader"in h)f=new FileReader,f.readAsBinaryString(a),f.onload=function(){b(f.result)};else return b(a.getAsBinary())}function q(a,b,f,c){var d,e,p,u,g=this;t(o[a.id],function(m){d=k.createElement("canvas");d.style.display="none";k.body.appendChild(d);e=d.getContext("2d");p=new Image;p.onerror=p.onabort=function(){c({success:!1})};
p.onload=function(){var j,h,x,k;b.width||(b.width=p.width);b.height||(b.height=p.height);u=Math.min(b.width/p.width,b.height/p.height);if(1>u||1===u&&"image/jpeg"===f){j=Math.round(p.width*u);h=Math.round(p.height*u);d.width=j;d.height=h;e.drawImage(p,0,0,j,h);if("image/jpeg"===f){if(x=new l(atob(m.substring(m.indexOf("base64,")+7))),x.headers&&x.headers.length&&(k=new n,k.init(x.get("exif")[0])&&(k.setExif("PixelXDimension",j),k.setExif("PixelYDimension",h),x.set("exif",k.getBinary()),g.hasEventListener("ExifData")&&
g.trigger("ExifData",a,k.EXIF()),g.hasEventListener("GpsData")&&g.trigger("GpsData",a,k.GPS()))),b.quality)try{m=d.toDataURL(f,b.quality/100)}catch(t){m=d.toDataURL(f)}}else m=d.toDataURL(f);m=m.substring(m.indexOf("base64,")+7);m=atob(m);x&&x.headers&&x.headers.length&&(m=x.restore(m),x.purge());d.parentNode.removeChild(d);c({success:!0,data:m})}else c({success:!1})};p.src=m})}function w(){function a(a,b){var p=f?0:-8*(b-1),u=0,g;for(g=0;g<b;g++)u|=c.charCodeAt(a+g)<<Math.abs(p+8*g);return u}function b(a,
b,p){p=3===arguments.length?p:c.length-b-1;c=c.substr(0,b)+a+c.substr(p+b)}var f=!1,c;return{II:function(a){if(a===s)return f;f=a},init:function(a){f=!1;c=a},SEGMENT:function(a,e,p){switch(arguments.length){case 1:return c.substr(a,c.length-a-1);case 2:return c.substr(a,e);case 3:b(p,a,e);break;default:return c}},BYTE:function(b){return a(b,1)},SHORT:function(b){return a(b,2)},LONG:function(d,e){if(e===s)return a(d,4);var c="",u=f?0:-24,g;for(g=0;4>g;g++)c+=String.fromCharCode(e>>Math.abs(u+8*g)&
255);b(c,d,4)},SLONG:function(b){b=a(b,4);return 2147483647<b?b-4294967296:b},STRING:function(b,e){for(var c="",e=e+b;b<e;b++)c+=String.fromCharCode(a(b,1));return c}}}function l(a){var b={65505:{app:"EXIF",name:"APP1",signature:"Exif\x00"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\x00"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\x00"}},f=[],c,d,e=s,p=0;c=new w;c.init(a);if(65496===c.SHORT(0)){d=2;for(a=Math.min(1048576,a.length);d<=a;)if(e=c.SHORT(d),65488<=e&&65495>=e)d+=
2;else{if(65498===e||65497===e)break;p=c.SHORT(d+2)+2;b[e]&&c.STRING(d+4,b[e].signature.length)===b[e].signature&&f.push({hex:e,app:b[e].app.toUpperCase(),name:b[e].name.toUpperCase(),start:d,length:p,segment:c.SEGMENT(d,p)});d+=p}c.init(null);return{headers:f,restore:function(a){c.init(a);var b=new l(a);if(!b.headers)return!1;for(a=b.headers.length;0<a;a--){var e=b.headers[a-1];c.SEGMENT(e.start,e.length,"")}b.purge();d=65504==c.SHORT(2)?4+c.SHORT(4):2;a=0;for(b=f.length;a<b;a++)c.SEGMENT(d,0,f[a].segment),
d+=f[a].length;return c.SEGMENT()},get:function(a){for(var b=[],e=0,c=f.length;e<c;e++)f[e].app===a.toUpperCase()&&b.push(f[e].segment);return b},set:function(a,b){var e=[];"string"===typeof b?e.push(b):e=b;for(var c=ii=0,d=f.length;c<d&&!(f[c].app===a.toUpperCase()&&(f[c].segment=e[ii],f[c].length=e[ii].length,ii++),ii>=e.length);c++);},purge:function(){f=[];c.init(null)}}}}function n(){function a(a,p){var f=b.SHORT(a),g,m,j,h,k,l=[],t={};for(g=0;g<f;g++)if(k=a+12*g+2,j=p[b.SHORT(k)],j!==s){m=b.SHORT(k+=
2);h=b.LONG(k+=2);k+=4;l=[];switch(m){case 1:case 7:4<h&&(k=b.LONG(k)+c.tiffHeader);for(m=0;m<h;m++)l[m]=b.BYTE(k+m);break;case 2:4<h&&(k=b.LONG(k)+c.tiffHeader);t[j]=b.STRING(k,h-1);continue;case 3:2<h&&(k=b.LONG(k)+c.tiffHeader);for(m=0;m<h;m++)l[m]=b.SHORT(k+2*m);break;case 4:1<h&&(k=b.LONG(k)+c.tiffHeader);for(m=0;m<h;m++)l[m]=b.LONG(k+4*m);break;case 5:k=b.LONG(k)+c.tiffHeader;for(m=0;m<h;m++)l[m]=b.LONG(k+4*m)/b.LONG(k+4*m+4);break;case 9:k=b.LONG(k)+c.tiffHeader;for(m=0;m<h;m++)l[m]=b.SLONG(k+
4*m);break;case 10:k=b.LONG(k)+c.tiffHeader;for(m=0;m<h;m++)l[m]=b.SLONG(k+4*m)/b.SLONG(k+4*m+4);break;default:continue}h=1==h?l[0]:l;t[j]=d.hasOwnProperty(j)&&"object"!=typeof h?d[j][h]:h}return t}var b,f,c={},d;b=new w;f={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",
37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{"0":"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}};d={ColorSpace:{1:"sRGB","0":"Uncalibrated"},MeteringMode:{"0":"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",
2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{"0":"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",
9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",
71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},
ExposureMode:{"0":"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{"0":"Auto white balance",1:"Manual white balance"},SceneCaptureType:{"0":"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{"0":"Normal",1:"Soft",2:"Hard"},Saturation:{"0":"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{"0":"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};return{init:function(e){c=
{tiffHeader:10};if(e===s||!e.length)return!1;b.init(e);65505===b.SHORT(0)&&"EXIF\x00"===b.STRING(4,5).toUpperCase()?(e=s,e=c.tiffHeader,b.II(18761==b.SHORT(e)),42!==b.SHORT(e+=2)?e=!1:(c.IFD0=c.tiffHeader+b.LONG(e+2),e=a(c.IFD0,f.tiff),c.exifIFD="ExifIFDPointer"in e?c.tiffHeader+e.ExifIFDPointer:s,c.gpsIFD="GPSInfoIFDPointer"in e?c.tiffHeader+e.GPSInfoIFDPointer:s,e=!0)):e=!1;return e},EXIF:function(){var b;b=a(c.exifIFD,f.exif);if(b.ExifVersion&&"array"===j.typeOf(b.ExifVersion)){for(var d=0,g="";d<
b.ExifVersion.length;d++)g+=String.fromCharCode(b.ExifVersion[d]);b.ExifVersion=g}return b},GPS:function(){var b;b=a(c.gpsIFD,f.gps);b.GPSVersionID&&(b.GPSVersionID=b.GPSVersionID.join("."));return b},setExif:function(a,d){var g;if("PixelXDimension"!==a&&"PixelYDimension"!==a)g=!1;else{g=a;var h,m,k,j=0;if("string"===typeof g)for(hex in h=f.exif,h)if(h[hex]===g){g=hex;break}h=c.exifIFD;m=b.SHORT(h);for(i=0;i<m;i++)if(k=h+12*i+2,b.SHORT(k)==g){j=k+8;break}j?(b.LONG(j,d),g=!0):g=!1}return g},getBinary:function(){return b.SEGMENT()}}}
var o={},g;j.runtimes.Html5=j.addRuntime("html5",{getFeatures:function(){var a,b,f,c,d,e;b=f=d=e=!1;h.XMLHttpRequest&&(a=new XMLHttpRequest,f=!!a.upload,b=!(!a.sendAsBinary&&!a.upload));b&&(c=!!(a.sendAsBinary||h.Uint8Array&&h.ArrayBuffer),d=!(!File||!File.prototype.getAsDataURL&&!h.FileReader||!c),e=!(!File||!File.prototype.mozSlice&&!File.prototype.webkitSlice&&!File.prototype.slice));g=j.ua.safari&&j.ua.windows;a=b;b=k.createElement("div");return{html5:a,dragdrop:"draggable"in b||"ondragstart"in
b&&"ondrop"in b,jpgresize:d,pngresize:d,multipart:d||!!h.FileReader||!!h.FormData,canSendBinary:c,cantSendBlobInFormData:!(!j.ua.gecko||!h.FormData||!h.FileReader||FileReader.prototype.readAsArrayBuffer),progress:f,chunks:e,multi_selection:!(j.ua.safari&&j.ua.windows),triggerDialog:j.ua.gecko&&h.FormData||j.ua.webkit}},init:function(a,b){function f(b){var c,d,f=[],g,h={};for(d=0;d<b.length;d++)c=b[d],h[c.name]||(h[c.name]=!0,g=j.guid(),o[g]=c,f.push(new j.File(g,c.fileName||c.name,c.fileSize||c.size)));
f.length&&a.trigger("FilesAdded",f)}var c,d;c=this.getFeatures();c.html5?(a.bind("Init",function(b){var c,d,g=[],h,l,t=b.settings.filters,n,o;h=k.body;c=k.createElement("div");c.id=b.id+"_html5_container";j.extend(c.style,{position:"absolute",background:a.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:a.settings.shim_bgcolor?"":0});c.className="plupload html5";a.settings.container&&(h=k.getElementById(a.settings.container),"static"===j.getStyle(h,
"position")&&(h.style.position="relative"));h.appendChild(c);h=0;a:for(;h<t.length;h++){n=t[h].extensions.split(/,/);for(l=0;l<n.length;l++){if("*"===n[l]){g=[];break a}(o=j.mimeTypes[n[l]])&&-1===j.inArray(o,g)&&g.push(o)}}c.innerHTML='<input id="'+a.id+'_html5"  style="font-size:999px" type="file" accept="'+g.join(",")+'" '+(a.settings.multi_selection&&a.features.multi_selection?'multiple="multiple"':"")+" />";c.scrollTop=100;g=k.getElementById(a.id+"_html5");b.features.triggerDialog?j.extend(g.style,
{position:"absolute",width:"100%",height:"100%"}):j.extend(g.style,{cssFloat:"right",styleFloat:"right"});g.onchange=function(){f(this.files);this.value=""};if(d=k.getElementById(b.settings.browse_button)){var r=b.settings.browse_button_hover,q=b.settings.browse_button_active;c=b.features.triggerDialog?d:c;r&&(j.addEvent(c,"mouseover",function(){j.addClass(d,r)},b.id),j.addEvent(c,"mouseout",function(){j.removeClass(d,r)},b.id));q&&(j.addEvent(c,"mousedown",function(){j.addClass(d,q)},b.id),j.addEvent(k.body,
"mouseup",function(){j.removeClass(d,q)},b.id));b.features.triggerDialog&&j.addEvent(d,"click",function(a){var c=k.getElementById(b.id+"_html5");c&&!c.disabled&&c.click();a.preventDefault()},b.id)}}),a.bind("PostInit",function(){var b=k.getElementById(a.settings.drop_element);b&&(g?j.addEvent(b,"dragenter",function(){var c,d;c=k.getElementById(a.id+"_drop");c||(c=k.createElement("input"),c.setAttribute("type","file"),c.setAttribute("id",a.id+"_drop"),c.setAttribute("multiple","multiple"),j.addEvent(c,
"change",function(){f(this.files);j.removeEvent(c,"change",a.id);c.parentNode.removeChild(c)},a.id),b.appendChild(c));j.getPos(b,k.getElementById(a.settings.container));d=j.getSize(b);"static"===j.getStyle(b,"position")&&j.extend(b.style,{position:"relative"});j.extend(c.style,{position:"absolute",display:"block",top:0,left:0,width:d.w+"px",height:d.h+"px",opacity:0})},a.id):(j.addEvent(b,"dragover",function(a){a.preventDefault()},a.id),j.addEvent(b,"drop",function(a){var b=a.dataTransfer;b&&b.files&&
f(b.files);a.preventDefault()},a.id)))}),a.bind("Refresh",function(b){var c,d,f;if(c=k.getElementById(a.settings.browse_button))d=j.getPos(c,k.getElementById(b.settings.container)),f=j.getSize(c),b=k.getElementById(a.id+"_html5_container"),j.extend(b.style,{top:d.y+"px",left:d.x+"px",width:f.w+"px",height:f.h+"px"}),a.features.triggerDialog&&("static"===j.getStyle(c,"position")&&j.extend(c.style,{position:"relative"}),d=parseInt(j.getStyle(c,"z-index"),10),isNaN(d)&&(d=0),j.extend(c.style,{zIndex:d}),
j.extend(b.style,{zIndex:d-1}))}),a.bind("DisableBrowse",function(a,b){var c=k.getElementById(a.id+"_html5");c&&(c.disabled=b)}),a.bind("CancelUpload",function(){d.abort&&d.abort()}),a.bind("UploadFile",function(a,b){function f(a,b,c){var d;if(File.prototype.slice)try{return a.slice(),a.slice(b,c)}catch(e){return a.slice(b,c-b)}else return(d=File.prototype.webkitSlice||File.prototype.mozSlice)?d.call(a,b,c):null}function g(l){function t(){function g(f){var k=0,m="----pluploadboundary"+j.guid(),l,
r="";d=new XMLHttpRequest;d.upload&&(d.upload.onprogress=function(c){b.loaded=Math.min(b.size,o+c.loaded-k);a.trigger("UploadProgress",b)});d.onreadystatechange=function(){var c,g;if(4==d.readyState&&a.state!==j.STOPPED){try{c=d.status}catch(h){c=0}if(400<=c)a.trigger("Error",{code:j.HTTP_ERROR,message:j.translate("HTTP Error."),file:b,status:c});else{if(s){g={chunk:n,chunks:s,response:d.responseText,status:c};a.trigger("ChunkUploaded",b,g);o+=y;if(g.cancelled){b.status=j.FAILED;return}b.loaded=Math.min(b.size,
(n+1)*v)}else b.loaded=b.size;a.trigger("UploadProgress",b);f=q=l=r=null;!s||++n>=s?(b.status=j.DONE,a.trigger("FileUploaded",b,{response:d.responseText,status:c})):t()}}};if(a.settings.multipart&&c.multipart){w.name=b.target_name||b.name;d.open("post",A,!0);j.each(a.settings.headers,function(a,b){d.setRequestHeader(b,a)});if("string"!==typeof f&&h.FormData){l=new FormData;j.each(j.extend(w,a.settings.multipart_params),function(a,b){l.append(b,a)});l.append(a.settings.file_data_name,f);d.send(l);
return}if("string"===typeof f){d.setRequestHeader("Content-Type","multipart/form-data; boundary="+m);j.each(j.extend(w,a.settings.multipart_params),function(a,b){r+="--"+m+'\r\nContent-Disposition: form-data; name="'+b+'"\r\n\r\n';r+=unescape(encodeURIComponent(a))+"\r\n"});B=j.mimeTypes[b.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream";r+="--"+m+'\r\nContent-Disposition: form-data; name="'+a.settings.file_data_name+'"; filename="'+unescape(encodeURIComponent(b.name))+
'"\r\nContent-Type: '+B+"\r\n\r\n"+f+"\r\n--"+m+"--\r\n";k=r.length-f.length;f=r;if(d.sendAsBinary)d.sendAsBinary(f);else if(c.canSendBinary){for(var u=new Uint8Array(f.length),z=0;z<f.length;z++)u[z]=f.charCodeAt(z)&255;d.send(u.buffer)}return}}A=j.buildUrl(a.settings.url,j.extend(w,a.settings.multipart_params));d.open("post",A,!0);d.setRequestHeader("Content-Type","application/octet-stream");j.each(a.settings.headers,function(a,b){d.setRequestHeader(b,a)});d.send(f)}var q,s,w,v,y,B,A=a.settings.url;
b.status==j.DONE||b.status==j.FAILED||a.state==j.STOPPED||(w={name:b.target_name||b.name},k.chunk_size&&b.size>k.chunk_size&&(c.chunks||"string"==typeof l)?(v=k.chunk_size,s=Math.ceil(b.size/v),y=Math.min(v,b.size-n*v),q="string"==typeof l?l.substring(n*v,n*v+y):f(l,n*v,n*v+y),w.chunk=n,w.chunks=s):(y=b.size,q=l),a.settings.multipart&&c.multipart&&"string"!==typeof q&&r&&c.cantSendBlobInFormData&&c.chunks&&a.settings.chunk_size?(r.onload=function(){g(r.result)},r.readAsBinaryString(q)):g(q))}var n=
0,o=0,r="FileReader"in h?new FileReader:null;t()}var k=a.settings,l;l=o[b.id];c.jpgresize&&a.settings.resize&&/\.(png|jpg|jpeg)$/i.test(b.name)?q.call(a,b,a.settings.resize,/\.png$/i.test(b.name)?"image/png":"image/jpeg",function(a){a.success?(b.size=a.data.length,g(a.data)):c.chunks?g(l):r(l,g)}):!c.chunks&&c.jpgresize?r(l,g):g(l)}),a.bind("Destroy",function(a){var b,c,d=k.body,f={inputContainer:a.id+"_html5_container",inputFile:a.id+"_html5",browseButton:a.settings.browse_button,dropElm:a.settings.drop_element};
for(b in f)(c=k.getElementById(f[b]))&&j.removeAllEvents(c,a.id);j.removeAllEvents(k.body,a.id);a.settings.container&&(d=k.getElementById(a.settings.container));d.removeChild(k.getElementById(f.inputContainer))}),b({success:!0})):b({success:!1})}})})(window,document,plupload);
(function(h){function k(h){return plupload.translate(h)||h}function j(j,r){r.contents().each(function(k,j){j=h(j);j.is(".plupload")||j.remove()});r.prepend('<div class="plupload_wrapper plupload_scroll"><div id="'+j+'_container" class="plupload_container"><div class="plupload"><div class="plupload_header"><div class="plupload_header_content"><div class="plupload_header_title">'+k("Select photos")+'</div><div class="plupload_header_text">'+k("Add photos to the upload queue and click the start button.")+
'</div></div></div><div class="plupload_content"><div class="plupload_filelist_footer"><div class="plupload_file_name"><div class="plupload_buttons"><a href="#" class="plupload_button plupload_add">'+k("Add photos")+'</a><a href="#" class="plupload_button plupload_start">'+k("Start upload")+'</a></div><span class="plupload_upload_status"></span></div><div class="plupload_file_action"></div><div class="plupload_file_status"><span class="plupload_total_status">0%</span></div><div class="plupload_file_size"><span class="plupload_total_file_size">0 b</span></div><div class="plupload_progress"><div class="plupload_progress_container"><div class="plupload_progress_bar"></div></div></div><div class="plupload_clearer">&nbsp;</div></div><div class="plupload_filelist_header"><div class="plupload_file_name">'+
k("Filename")+'</div><div class="plupload_file_action">&nbsp;</div><div class="plupload_file_status"><span>'+k("Status")+'</span></div><div class="plupload_file_size">'+k("Size")+'</div><div class="plupload_clearer">&nbsp;</div></div><ul id="'+j+'_filelist" class="plupload_filelist"></ul></div></div></div><input type="hidden" id="'+j+'_count" name="'+j+'_count" value="0" /></div>')}var s={};h.fn.pluploadQueue=function(t){return t?(this.each(function(){function r(g){var a;g.status==plupload.DONE&&
(a="plupload_done");g.status==plupload.FAILED&&(a="plupload_failed");g.status==plupload.QUEUED&&(a="plupload_delete");g.status==plupload.UPLOADING&&(a="plupload_uploading");a=h("#"+g.id).attr("class",a).find("a").css("display","block");g.hint&&a.attr("title",g.hint)}function q(){h("span.plupload_total_status",n).html(l.total.percent+"%");h("div.plupload_progress_bar",n).css("width",l.total.percent+"%");h("span.plupload_upload_status",n).text(k("Uploaded %d/%d files").replace(/%d\/%d/,l.total.uploaded+
"/"+l.files.length))}function w(){var g=h("ul.plupload_filelist",n).html(""),a=0,b;h.each(l.files,function(f,c){b="";c.status==plupload.DONE&&(c.target_name&&(b+='<input type="hidden" name="'+o+"_"+a+'_tmpname" value="'+plupload.xmlEncode(c.target_name)+'" />'),b+='<input type="hidden" name="'+o+"_"+a+'_name" value="'+plupload.xmlEncode(c.name)+'" />',b+='<input type="hidden" name="'+o+"_"+a+'_status" value="'+(c.status==plupload.DONE?"done":"failed")+'" />',a++,h("#"+o+"_count").val(a));g.append('<li id="'+
c.id+'"><div class="plupload_file_name"><span>'+c.name+'</span></div><div class="plupload_file_action"><a href="#"></a></div><div class="plupload_file_status">'+c.percent+'%</div><div class="plupload_file_size">'+plupload.formatSize(c.size)+'</div><div class="plupload_clearer">&nbsp;</div>'+b+"</li>");r(c);h("#"+c.id+".plupload_delete a").click(function(a){h("#"+c.id).remove();l.removeFile(c);a.preventDefault()})});h("span.plupload_total_file_size",n).html(plupload.formatSize(l.total.size));0===l.total.queued?
h("span.plupload_add_text",n).text(k("Add photos.")):h("span.plupload_add_text",n).text(l.total.queued+" photos queued.");h("a.plupload_start",n).toggleClass("plupload_disabled",l.files.length==l.total.uploaded+l.total.failed);g[0].scrollTop=g[0].scrollHeight;q();!l.files.length&&l.features.dragdrop&&l.settings.dragdrop&&h("#"+o+"_filelist").append('<li class="plupload_droptext">'+k("Drag photos here.")+"</li>")}var l,n,o;n=h(this);o=n.attr("id");o||(o=plupload.guid(),n.attr("id",o));l=new plupload.Uploader(h.extend({dragdrop:!0,
container:o},t));s[o]=l;l.bind("UploadFile",function(g,a){h("#"+a.id).addClass("plupload_current_file")});l.bind("Init",function(g,a){j(o,n);!t.unique_names&&t.rename&&h("#"+o+"_filelist div.plupload_file_name span",n).live("click",function(a){var f=h(a.target),c,d,e="";c=g.getFile(f.parents("li")[0].id);d=c.name;if(a=/^(.+)(\.[^.]+)$/.exec(d))d=a[1],e=a[2];f.hide().after('<input type="text" />');f.next().val(d).focus().blur(function(){f.show().next().remove()}).keydown(function(a){var b=h(this);
13==a.keyCode&&(a.preventDefault(),c.name=b.val()+e,f.text(c.name),b.blur())})});h("a.plupload_add",n).attr("id",o+"_browse");g.settings.browse_button=o+"_browse";g.features.dragdrop&&g.settings.dragdrop&&(g.settings.drop_element=o+"_filelist",h("#"+o+"_filelist").append('<li class="plupload_droptext">'+k("Drag photos here.")+"</li>"));h("#"+o+"_container").attr("title","Using runtime: "+a.runtime);h("a.plupload_start",n).click(function(a){h(this).hasClass("plupload_disabled")||l.start();a.preventDefault()});
h("a.plupload_stop",n).click(function(a){a.preventDefault();l.stop()});h("a.plupload_start",n).addClass("plupload_disabled")});l.init();l.bind("Error",function(g,a){var b=a.file,f;b&&(f=a.message,a.details&&(f+=" ("+a.details+")"),a.code==plupload.FILE_SIZE_ERROR&&alert(k("Error: File too large: ")+b.name),a.code==plupload.FILE_EXTENSION_ERROR&&alert(k("Error: Invalid file extension: ")+b.name),b.hint=f,h("#"+b.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",f))});
l.bind("StateChanged",function(){l.state===plupload.STARTED?(h("li.plupload_delete a,div.plupload_buttons",n).hide(),h("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",n).css("display","block"),h("span.plupload_upload_status",n).text("Uploaded "+l.total.uploaded+"/"+l.files.length+" files"),t.multiple_queues&&h("span.plupload_total_status,span.plupload_total_file_size",n).show()):(w(),h("a.plupload_stop,div.plupload_progress",n).hide(),h("a.plupload_delete",n).css("display","block"))});
l.bind("QueueChanged",w);l.bind("FileUploaded",function(g,a){r(a)});l.bind("UploadProgress",function(g,a){h("#"+a.id+" div.plupload_file_status",n).html(a.percent+"%");r(a);q();t.multiple_queues&&l.total.uploaded+l.total.failed==l.files.length&&(h(".plupload_buttons,.plupload_upload_status",n).css("display","inline"),h(".plupload_start",n).addClass("plupload_disabled"),h("span.plupload_total_status,span.plupload_total_file_size",n).hide())});t.setup&&t.setup(l)}),this):s[h(this[0]).attr("id")]}})(jQuery);
OPU=function(){var h=function(h,j){var k=h.name,q=j.name;return k<q?-1:k>q?1:0},k={success:[],failure:[],duplicate:[],ids:[]},j=function(h){"undefined"!==typeof console&&"undefined"!==typeof console.log&&console.log(h)};return{init:function(){var s=$("#uploader");0!=s.length&&("undefined"==typeof s.pluploadQueue?$("#uploader .insufficient").show():(s.pluploadQueue({runtimes:"html5",url:"/photo/upload.json",max_file_size:"32mb",file_data_name:"photo",unique_names:!0,filters:[{title:"Photos",extensions:"jpg,jpeg,gif,png"}],
flash_swf_url:"plupload.flash.swf",multipart_params:{crumb:$("form.upload input.crumb").val()},preinit:{BeforeUpload:function(){var h=$("#uploader").pluploadQueue();$(".upload-progress .total").html(h.files.length);$(".upload-progress .completed").html(h.total.uploaded+1);$(".upload-progress").slideDown("fast")},FilesAdded:function(j,k){var q=j.files.concat(k);q.sort(h);j.files=q},FileUploaded:function(h,r,q){q=$.parseJSON(q.response);h=q.code;q=q.result;201===h?(j("Successfully uploaded "+r.name+
" at "+q.url),k.success.push(q),k.ids.push(q.id)):409===h?(j("Detected a duplicate of "+r.name),k.duplicate.push(q),k.ids.push(q.id)):(j("Unable to upload "+r.name),k.failure.push(r.name))},UploadComplete:function(h,j){var q,s,l=0,n=0;for(q in j)j.hasOwnProperty(q)&&(n++,s=j[q],s.status!==plupload.DONE&&l++);0===l?OP.Util.fire("upload:complete-success",k):OP.Util.fire("upload:complete-error",k)},UploadFile:function(){var h=$("#uploader").pluploadQueue(),j=$("form.upload"),k=$("select[name='license'] :selected",
j).val(),s=$("input[name='permission']:checked",j).val(),l=$("select[name='albums']",j).val(),n=$("input[name='tags']",j).val(),j=$("select[name='groups']",j).val();"undefined"===typeof l?l="":null!==l&&(l=l.join(","));"undefined"===typeof j?greoups="":null!==j&&(j=j.join(","));h.settings.multipart_params.license=k;h.settings.multipart_params.tags=n;h.settings.multipart_params.permission=s;h.settings.multipart_params.albums=l;h.settings.multipart_params.groups=j}}}),OP.Util.on("submit:photo-upload",
function(h){h.preventDefault();h=$("#uploader").pluploadQueue();"undefined"!=typeof h.files&&0<h.files.length?h.start():opTheme.message.error("Please select at least one photo to upload.")})))}}}();
